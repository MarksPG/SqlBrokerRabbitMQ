
--this script creates / alters a SQLCLR assembly
--it HAS to be run with sa permissions!!!!

USE RabbitMQTest;
GO

SET NOCOUNT ON;

--the binary representation of RabbitMQ.Client (.NET 3.5)
DECLARE @AssemblyData VARBINARY(MAX)
SET @AssemblyData = 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300047F9C580000000000000000E00022200B013000002A000000060000000000001E49000000200000006000000000001000200000000200000400000000000000040000000000000000A000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000CC4800004F00000000600000B803000000000000000000000000000000000000008000000C000000944700001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E746578740000002429000000200000002A000000020000000000000000000000000000200000602E72737263000000B80300000060000000040000002C0000000000000000000000000000400000402E72656C6F6300000C000000008000000002000000300000000000000000000000000000400000420000000000000000000000000000000000490000000000004800000002000500182A00007C1D000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001A7E050000042A1E0280050000042AAE168001000004730F00000A8002000004731000000A8003000004731100000A80040000041680010000042A001B300400AD00000001000011281200000A2C0872010000700A2B067E050000040A06731300000A0B076F1400000A0C0872350000706F1500000A081A6F1600000A086F1700000A726D0000701F0C20000200006F1800000A26086F1700000A166F1900000A186F1A00000A076F1B00000A086F1C00000A26086F1700000A166F1900000A6F1D00000A6F1E00000A8005000004DE0A082C06086F1F00000ADCDE0A072C06076F1F00000ADCDE0B6F2000000A732100000A7A2A00000001280000020023006689000A0000000002001C007995000A0000000000000000A1A1000B130000012E280400000628060000062A1B30030033020000020000117E05000004730F00000A0A732200000A0B732200000A0C7E020000046F2300000A280100002B0D731300000A130411046F1400000A1305110572850000706F1500000A11051A6F1600000A11046F1B00000A11056F2500000A130611066F2600000A2C362B2B1106732700000613070611076F0F00000611076F2700000A7E0200000411076F0F00000611076F2700000A11066F2800000A2DCCDE0C11052C0711056F1F00000ADC7E020000046F2300000A066F2300000A280200002B280100002B0B07280300002B2C5D076F2B00000A13082B3A1208282C00000A13097E030000041109120A6F2D00000A2C14110A6F0E0000067E0300000411096F2E00000A267E0200000411096F2F00000A261208283000000A2DBDDE0E1208FE160400001B6F1F00000ADC7E020000046F2300000A09280200002B280100002B0C08280300002B39AD000000086F2B00000A130838840000007329000006130B110B1208282C00000A7D170000047E02000004110BFE062A000006733100000A280400002B7E19000004252D17267E18000004FE062D000006733300000A258019000004280500002B280600002B6F25000006110B7B170000041B730B000006130C7E03000004110B7B17000004110C6F3600000A110C6F0C000006261208283000000A3A70FFFFFFDE0E1208FE160400001B6F1F00000ADCDE0C11042C0711046F1F00000ADC066F3700000A2D0B72B9000070732100000A7ADE19130D72FF000070110D6F2000000A283800000A732100000A7A2A00417C00000200000037000000650000009C0000000C0000000000000002000000D3000000470000001A0100000E00000000000000020000005101000097000000E80100000E00000000000000020000002E000000CA010000F80100000C000000000000000000000000000000190200001902000019000000130000011B3001002D000000030000117E040000040A06283900000A7E010000042D0B2805000006178001000004DE0706283A00000ADCDE0326FE1A2A000000011C000002000C0014200007000000000000000029290003130000011B3005000901000004000011022D0B72B6010070732100000A7A7E010000042D052807000006283B00000A036F3C00000A0A021540860000007E020000046F3D00000A0B2B601201283E00000A0C1202283F00000A6F1D0000060D1202283F00000A6F1F00000613047E030000046F4000000A6F4100000A13052B111205284200000A090611046F0D000006261205284300000A2DE6DE0E1205FE160A00001B6F1F00000ADC1201284400000A2D97DE5E1201FE160700001B6F1F00000ADC7E030000040212066F2D00000A2C2B11067E02000004026F4500000A6F1D000006067E02000004026F4500000A6F1F0000066F0D000006262B1672E4010070028C33000001283800000A732100000A7ADE0326FE1A2A000000414C0000020000006E0000001E0000008C0000000E0000000000000002000000380000006D000000A50000000E0000000000000000000000000000000501000005010000030000000F0000011B30010017000000000000007E010000042D0528070000062806000006DE0326FE1A2A000110000000000000131300030F0000011E02281100000A2A9E02734600000A7D0B00000402281100000A02037D0800000402057D0900000402047D0A0000042A1B300200790000000500001102734700000A7D07000004027B07000004027B080000046F4800000A027B07000004177D4900000A027B07000004177D4A00000A02027B070000046F4B00000A7D06000004160A2B1C027B060000046F4C00000A0B027B0B000004076F4D00000A0617580A06027B0900000432DB170CDE0526160CDE00082A000000011000000000000072720005130000011B3006006A00000006000011140A160B2B0B0717580B1F32284E00000A027B0B00000412006F4F00000A2D05071F6432E1071F643311722402007003283800000A732100000A7A0603051614046F5000000A027B0B000004066F4D00000A170CDE1226062C0C027B0B000004066F4D00000AFE1A082A0000011000000000040052560012130000011B30020041000000070000112B17027B0B00000412006F4F00000A2C08066F5100000A140A027B0B0000046F5200000A1630DB027B060000046F5300000ADE0C027B0B0000046F5400000ADC2A00000001100000020000003434000C000000001E027B0C0000042A2202037D0C0000042A1E027B0D0000042A2202037D0D0000042A1E027B0E0000042A2202037D0E0000042A1E027B0F0000042A2202037D0F0000042A1E027B100000042A2202037D100000042A1E027B110000042A2202037D110000042A1E027B120000042A2202037D120000042A1E027B130000042A2202037D130000042A1E027B140000042A2202037D140000042A1E027B150000042A2202037D150000042A1E027B160000042A2202037D160000042A1E0228280000062A0013300300A90000000000000002281100000A0203166F5500000A28100000060203176F5600000A28120000060203186F5600000A28140000060203196F5500000A281600000602031A6F5600000A281800000602031B6F5600000A281A00000602031C6F5600000A281C00000602031D6F5600000A281E00000602031E6F5700000A7E5800000A3303142B07031E6F5600000A282000000602031F096F5500000A282200000602031F0A6F5900000A28240000062A000000133003009000000008000011735A00000A2572AB0200706F5B00000A26250228190000066F5B00000A262572BB0200706F5B00000A262502281B0000066F5B00000A262572BF0200706F5B00000A26250228130000066F5B00000A262572BB0200706F5B00000A26250228150000060A1200285C00000A6F5B00000A262572C30200706F5B00000A26250228170000066F5B00000A266F1E00000A2A420F01285D00000A027B17000004FE012A2E732C00000680180000042A220F01283F00000A2A000042534A4201000100000000000C00000076322E302E35303732370000000005006C000000A00A0000237E00000C0B0000B80B000023537472696E677300000000C4160000C8020000235553008C1900001000000023475549440000009C190000E003000023426C6F620000000000000002000001571DA209090A000000FA013300160000010000003700000006000000190000002D000000170000005D000000010000003000000008000000020000000D000000190000000B000000010000000500000002000000060000000000BE06010000000000060005050A09060072050A0906005204D8080F002A09000006007A0406070600E80406070600C904060706005905060706002505060706003E05060706009104060706006604EB0806004404EB080600AC0406070600420AE40606009E00F2000A007707840A0A00FD02840A0600B107E40606007800F2000A002008840A5300B80800004300B808000006008F00F2004300180700006700B8080000060029040A090E008800E40612004D07740A1200A30B740A16006600A60A1200AB06740A0A004E0B79080A00E502BB070A00ED03D3000A002807840A0A006608840A0A00DF03D3000A005A08BB070A009307D3000A005907BB0706007D03E4060600A607E40643003F0700000E007203FE0706005800F2000A001308BB0706007106E4060600D008B3050600C405320B06008200E40606004C01B30512003909740A0600D406E40606003C08320B00000000CA000000000001000100010000009408A6083D0001000100000010004A08A6083D0006000B0000001000C40A4A093D000C000F0003011000010000003D001700290003211000E80000003D0018002B001600A40139021300E409AE021300C309B70213000B04C0021100DC05C3020300FB06C6020100960BCA020100F105C3020100B909CE0203003601CE022100A909D1020100B601CE0201005D02C30201004102C30201009C02CE020100B202C30201002602C3020100ED01C30201000C02C3020100C902C30201007802CE020100D20139020600B301CE023600C600DA0216003100DE0250200000000096082906ED02010057200000000096084706F10201005F20000000009118C908F60202008C20000000009300110BF602020070210000000093001004F60202007C21000000009300F509F60202003824000000009600E407F602020090240000000096007806FA020200F425000000009600090AF60204002826000000008618C308060004003026000000008318C308000304005826000000008300500AC8000700F026000000008300240B070307007827000000008300CE0706000A00D827000000008308180161000A00E027000000008308270101000A00E927000000008308C30369000B00F127000000008308D10310000B00FA27000000008308A50369000C000228000000008308B40310000C000B28000000008308E40A61000D001328000000008308ED0A01000D001C28000000008308FD0A69000E002428000000008308070B10000E002D28000000008308890369000F003528000000008308970310000F003E280000000083080F036900100046280000000083082103100010004F280000000083083F036900110057280000000083084C03100011006028000000008308640B690012006828000000008308730B1000120071280000000083087B0961001300792800000000830892090100130082280000000083085701C80014008A280000000083086501150014009328000000008608FD05690015002826000000008318C308060015009C28000000008318C3080F03150054290000000081001206690016002826000000008618C30806001600F029000000008300170015031600012A000000009118C908F60217002826000000008618C308060017000D2A0000000083003B002003170000000100A605000001000D01000002001F0B00000100CD05000002000D0110100300BA09000001005903000002008D0600000300EC0000000100A60500000100A60500000100A60500000100A60500000100A60500000100A60500000100A60500000100A60500000100A60500000100A60500000100A60500000100100800000100590B00000100D6080900C30801001100C30806001900C3080A002900C30810003100C30810003900C30810004100C30810004900C30810005100C30810005900C30810006100C30815006900C30810007100C3081000D900C30806000C00C30806001400C30806007900C30806000901620332008900C30810008900EF02360011013E0B10001101E9033B009100D50942002101530148002101DB065300390185075A004901F60606001101860B61003901900565007900650669005101210406009900330369005901C30810001C00C30806000C00320AA2006901F60AAE0091002E08C3007901260AC8000C005301CC0079014701C8006901DD0AD4006901820BED001C00B508F90024009A0A080114009A050D011400AC0516010C00AC0516012400290BC8002C00C30829016901F9032F013400C30829016901490A60016901650A860114005301CC000C00D30A610081013B0A980189017308A2018901600AA2019101BD00C50191016709CB010C00B508D1013C009A0AE40144009005F70114007009FC014C00B5080F0254009A0AF7015400290BC8003C00290BC8000C00DB0622025C00C3080600F100C3080600F100A3061000F10073013902F1008C013902F10066073C02E900B20641025C009E064702A101D70755025C00DD075A0201019106610201011B0406005C00D30A6100E9001B0406005C000A08060079017F00730279016E0678027901DB067D02B101A00582027901EB068702B901C3080600B9010803900299016506690044005C0B080108001900A9022E000B003C032E00130045032E001B0064032E0023006D032E002B0084032E00330084032E003B0084032E0043006D032E004B008A032E00530084032E005B0084032E006300A2032E006B00CC03A3007300D903C3007300D90381017300D903A1017300D903C1017300D903E0017300D903E1017300D90300027300D90301027300D90320027300D90321027300D90340027300D90341027300D90360027300D90361027300D90380027300D90381027300D903A0027300D903A1027300D903C0027300D903C1027300D903E0027300D90300037300D90320037300D90340037300D90360037300D90380037300D903A0037300D903C0037300D903E0037300D90300047300D90320047300D90340047300D90360047300D90380047300D9032A006D009E01A70131024D026D028C02020001000400020000004B062C0300003C0130030000D50334030000B80334030000F10A300300000B0B340300009B0334030000250334030000500334030000770B340300009609300300006901380300005406340302000100030001000200030002000F000500010010000500020011000700010012000700020013000900010014000900020015000B00010016000B00020017000D00010018000D00020019000F0001001A000F0002001B00110001001C00110002001D00130001001E00130002001F001500010020001500020021001700010022001700020023001900010024001900020025001B001A0022009C0002011C015201DC01EF0107021A022902048000000100000000000000000000000000AB0000000200000000000000000000009702DF00000000000200000000000000000000009702D300000000000300050000000000000000009702FF03000000000000000000000000000000000000740A0000000001000000280B660000000000A002B3050000000005000200060002004900BF005300BF005500BF006500480169007A016B0093010000003C3E635F5F446973706C6179436C61737331315F30003C4C6F6164526162626974456E64706F696E74733E625F5F30003C3E395F5F31315F31003C4C6F6164526162626974456E64706F696E74733E625F5F31315F310049456E756D657261626C65603100436F6E63757272656E74537461636B6031004C697374603100476574496E7433320046756E636032004B657956616C75655061697260320044696374696F6E6172796032005261626269744D5153716C436C72332E35006765745F55544638003C3E39003C4D6F64756C653E0053797374656D2E44617461006D73636F726C6962003C3E6300746F7069630053797374656D2E436F6C6C656374696F6E732E47656E6572696300656E64506F696E744964006765745F456E64706F696E744964007365745F456E64706F696E74496400526162626974456E64706F696E74496400526561640054687265616400416464006765745F4973456E61626C6564007365745F4973456E61626C6564004175746F6D617469635265636F76657279456E61626C656400546F706F6C6F67795265636F76657279456E61626C6564005F6973496E697469616C69736564006964003C456E64706F696E7449643E6B5F5F4261636B696E674669656C64003C4973456E61626C65643E6B5F5F4261636B696E674669656C64003C4C6F67696E50617373776F72643E6B5F5F4261636B696E674669656C64003C45786368616E67653E6B5F5F4261636B696E674669656C64003C4C6F67696E4E616D653E6B5F5F4261636B696E674669656C64003C5365727665724E616D653E6B5F5F4261636B696E674669656C64003C416C6961734E616D653E6B5F5F4261636B696E674669656C64003C436F6E6E656374696F6E4368616E6E656C733E6B5F5F4261636B696E674669656C64003C506F72743E6B5F5F4261636B696E674669656C64003C56486F73743E6B5F5F4261636B696E674669656C64003C526F7574696E674B65793E6B5F5F4261636B696E674669656C64004462436F6D6D616E6400437265617465436F6D6D616E640053716C436F6D6D616E6400417070656E64006765745F4C6F67696E50617373776F7264007365745F4C6F67696E50617373776F7264006765745F4D657373616765006765745F45786368616E6765007365745F45786368616E67650065786368616E6765006765745F4973417661696C61626C6500456E756D657261626C650049446973706F7361626C65006765745F4C6F67696E4E616D65007365745F4C6F67696E4E616D65006765745F5365727665724E616D65007365745F5365727665724E616D65006765745F416C6961734E616D65007365745F416C6961734E616D650053716C446254797065007365745F436F6D6D616E64547970650057686572650053797374656D2E436F7265005F6C6F636B496E697469616C69736500436C6F736500446973706F736500436F6D70696C657247656E65726174656441747472696275746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465006765745F56616C75650054727947657456616C75650076616C75650052656D6F76650053797374656D2E546872656164696E6700456E636F64696E6700616D7170436F6E6E537472696E67005F6C6F63616C686F7374436F6E6E537472696E67005F636F6E6E537472696E67006765745F436F6E6E656374696F6E537472696E6700437265617465436F6E6E656374696F6E537472696E67006765745F4C6F63616C686F7374436F6E6E656374696F6E537472696E67007365745F4C6F63616C686F7374436F6E6E656374696F6E537472696E6700546F537472696E6700476574537472696E670070725F636C725F506F73745261626269744D7367006D73670042617369635075626C6973680050757368007365745F55726900494D6F64656C004372656174654D6F64656C005261626269744D5153716C436C72332E352E646C6C0044424E756C6C006765745F4974656D0053797374656D00476574426F6F6C65616E004F70656E00526162626974436F6E6E0053797374656D2E5265666C656374696F6E0056616C7565436F6C6C656374696F6E0053716C506172616D65746572436F6C6C656374696F6E004B6579436F6C6C656374696F6E0049436F6E6E656374696F6E004462436F6E6E656374696F6E00437265617465436F6E6E656374696F6E0053716C436F6E6E656374696F6E007365745F446972656374696F6E00506172616D65746572446972656374696F6E004170706C69636174696F6E457863657074696F6E0053797374656D2E446174612E436F6D6D6F6E0053687574646F776E00536C65657000547279506F700070725F636C725F496E697469616C6973655261626269744D710053797374656D2E4C696E7100436C656172006472004462446174615265616465720053716C44617461526561646572004578656375746552656164657200537472696E674275696C646572005261626269745075626C6973686572004462506172616D657465720053716C506172616D6574657200456E746572004D6963726F736F66742E53716C5365727665722E536572766572005261626269744D5153716C536572766572005261626269744D5153716C436C7200476574456E756D657261746F72002E63746F72002E6363746F72004D6F6E69746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730049426173696350726F70657274696573005261626269744D5153716C436C722E48656C706572436C6173736573004765744279746573006765745F56616C756573006765745F436F6E6E656374696F6E4368616E6E656C73007365745F436F6E6E656374696F6E4368616E6E656C73005F7261626269744368616E6E656C73005F6368616E6E656C73005F7261626269745075626C697368657273006765745F506172616D6574657273005F72656D6F7465456E64706F696E7473004C6F6164526162626974456E64706F696E74730070725F636C725F52656C6F6164526162626974456E64706F696E7473006765745F486173526F7773006765745F4B65797300466F726D6174004F626A6563740053656C65637400496E7465726E616C436F6E6E65637400457869740046697273744F7244656661756C74005261626269744D512E436C69656E740053797374656D2E446174612E53716C436C69656E74006765745F43757272656E740053797374656D2E436F6C6C656374696F6E732E436F6E63757272656E740052656D6F7465456E64706F696E74006765745F436F756E7400457863657074006765745F506F7274007365745F506F727400546F4C697374006765745F56486F7374007365745F56486F7374004C6F61644C6F63616C486F7374006D7367546F506F7374004D6F76654E6578740053797374656D2E54657874007365745F436F6D6D616E64546578740053716C436F6E74657874006578006765745F4B6579006765745F526F7574696E674B6579007365745F526F7574696E674B657900416E7900457865637574654E6F6E5175657279005F636F6E6E466163746F727900436F6E6E656374696F6E466163746F727900000000003343006F006E007400650078007400200043006F006E006E0065006300740069006F006E0020003D0020007400720075006500003772006D0071002E00700072005F004700650074004C006F00630061006C004400420043006F006E006E0053007400720069006E0067000017400043006F006E006E0053007400720069006E006700003372006D0071002E00700072005F0047006500740052006100620062006900740045006E00640070006F0069006E007400730000454E006F00200065006E00610062006C00650064002000720061006200620069007400200065006E00640070006F0069006E007400730020006500780069007300740073000080B54500720072006F007200200069006E003A0020005200610062006200690074004D005100530071006C005300650072007600650072002E004C006F006100640052006100620062006900740045006E00640070006F0069006E00740073002E00200054006800650020006500720072006F0072002000690073003A0020004500720072006F0072002000720061006200620069007400200065006E00640070006F0069006E00740073003A0020007B0030007D00002D45006E00640070006F0069006E007400490064002000630061006E006E006F00740020006200650020003000003F45006E00640070006F0069006E007400490064003A0020007B0030007D002C00200064006F006500730020006E006F0074002000650078006900730074000080854300680061006E006E0065006C00200070006F006F006C00200062006C006F0063006B006500640020007700680065006E00200074007200790069006E006700200074006F00200070006F007300740020006D00650073007300610067006500200074006F002000450078006300680061006E00670065003A0020007B0030007D002E00000F61006D00710070003A002F002F0000033A000003400000032F00000041F8754F9B4D134A872EC45B29BAFC7200042001010803200001052001011111042001010E04200101020715124102081210071512410208120C0707030E124512490300000204200012490620010111808D0520001280910A20031280950E1180990806200112809508062001011180A1032000080320001C0320000E2E070E151241020812101512510108151251010815125101081245124912551210151159010808120C1214120C124D0515125101080B2000151280B1021300130110100101151251011E00151280B9011E00030A0108042000125503200002072002011300130118100102151280B9011E00151280B9011E00151280B9011E000B10010102151280B9011E0008200015115901130005151159010804200013000820020213001013010520010213000C151271021511610208121002052002011C1818100102151280B9011E00151280B9011E00151271021E0002090A01151161020812100D1512710215116102081210121019100202151280B9011E01151280B9011E00151271021E001E010B0A021511610208121012100C1001011E00151280B9011E00040A0112100500020E0E1C0307011C040001011C1D07071D0515115D02081210151161020812100E0E1511690208120C120C0500001280C90520011D050E0A200015115D02130013010715115D020812100A20001511610213001301071511610208121004200013010A20001512650213001301071512650208120C0A20001511690213001301071511690208120C062001130113000715127D011280810707030812808102020602042000127505200012808105200101130007070312808108020400010108062001021013000B2005010E0E021280D51D0505070112808104200108080420010E080420011C0804061280D90420010208030701080620011280DD0E08B77A5C561934E0890831BF3856AD364E35040500000008061512410208121008061512410208120C02061C02060E0306127503061279020608080615127D01128081030612180E06151271021511610208121012100300000E040001010E0300000105000201080E062003010E0808072003020E1D050E0520010112550A200102151161020812100B20011210151161020812100308000E032800080328000E032800020801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F777301080100020000000000160100115261626269744D5153716C436C72332E35000005010000000017010012436F7079726967687420C2A920203230313700002901002438396533616636352D613031312D346661302D393631612D32363435303763336565646100000C010007312E302E302E3000000401000000000000000000047F9C5800000000020000001C010000B0470000B02900005253445398B56B2DD17AD34AB09F2A3249DFC2F601000000443A5C5261626269744D512D53716C5365727665725C7372635C5261626269744D5153716C436C72332E355C6F626A5C52656C656173655C5261626269744D5153716C436C72332E352E706462000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F448000000000000000000000E49000000200000000000000000000000000000000000000000000000490000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF250020001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000586000005C03000000000000000000005C0334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004BC020000010053007400720069006E006700460069006C00650049006E0066006F0000009802000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E007400730000000000000022000100010043006F006D00700061006E0079004E0061006D00650000000000000000004C0012000100460069006C0065004400650073006300720069007000740069006F006E00000000005200610062006200690074004D005100530071006C0043006C00720033002E0035000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000004C001600010049006E007400650072006E0061006C004E0061006D00650000005200610062006200690074004D005100530071006C0043006C00720033002E0035002E0064006C006C0000004800120001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003100370000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000005400160001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000005200610062006200690074004D005100530071006C0043006C00720033002E0035002E0064006C006C000000440012000100500072006F0064007500630074004E0061006D006500000000005200610062006200690074004D005100530071006C0043006C00720033002E0035000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000C000000203900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

--the following name needs also to be used (without single-quotes)
-- in the CREATE and ALTER statements below
DECLARE @asmName sysname = 'RabbitMQ.SqlServer';

--end setting parameters

DECLARE @dbname nvarchar(256);
DECLARE @isTrustworthy bit;
DECLARE @alterStmt nvarchar(512);
DECLARE @isCLREnabled int;
DECLARE @isCreateAlter bit = 0;
DECLARE @spConfigureTab TABLE (name varchar(256), minimum int, maximum int, config_value int, run_value int)


--check if clr is enabled, if not return out - as it cannot be done dynamically
INSERT INTO @spConfigureTab
EXEC sp_Configure 'CLR Enabled'

SELECT @isCLREnabled = run_value
FROM @spConfigureTab

IF(@isCLREnabled = 0)
BEGIN
  RAISERROR('CLR is not enabled on this db server. To enable, execute "sp_configure ''CLR Enabled'', 1 GO RECONFIGURE GO". This script now exits.', 16, -1)
  RETURN;
END

--check if we are trustworthy
SELECT @dbname = name, @isTrustworthy = is_trustworthy_on 
FROM sys.databases
WHERE name = db_name()

IF (@isTrustworthy = 0)
BEGIN
  SET @alterStmt = 'ALTER DATABASE ' + @dbname + ' SET TRUSTWORTHY ON;'
  EXEC( @alterStmt);
END

IF NOT EXISTS (SELECT * FROM sys.assemblies asms WHERE asms.name = @asmName)
BEGIN

  CREATE ASSEMBLY [RabbitMQ.SqlServer]
  AUTHORIZATION rmq
  FROM @AssemblyData
  WITH PERMISSION_SET = UNSAFE;  	

END  
ELSE
BEGIN
  
  IF NOT EXISTS(SELECT 1 FROM sys.assembly_files WHERE content = @AssemblyData)
  BEGIN
  
    ALTER ASSEMBLY [RabbitMQ.SqlServer]
    FROM @AssemblyData
    WITH PERMISSION_SET = UNSAFE;

  END
  ELSE
  BEGIN
    PRINT 'The assembly already exists. It is not being altered.'
  END
  
END
GO



