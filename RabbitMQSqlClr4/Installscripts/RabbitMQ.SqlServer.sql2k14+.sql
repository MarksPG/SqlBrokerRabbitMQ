
--this script creates / alters a SQLCLR assembly
--it HAS to be run with sa permissions!!!!

USE RabbitMQTest;
GO

SET NOCOUNT ON;

--the binary representation of RabbitMQ.Client (.NET 3.5)
DECLARE @AssemblyData VARBINARY(MAX)
SET @AssemblyData = 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C01030059479C580000000000000000E00022200B013000002A00000006000000000000D649000000200000006000000000001000200000000200000400000000000000060000000000000000A000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000844900004F00000000600000A803000000000000000000000000000000000000008000000C0000004C4800001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000DC29000000200000002A000000020000000000000000000000000000200000602E72737263000000A80300000060000000040000002C0000000000000000000000000000400000402E72656C6F6300000C0000000080000000020000003000000000000000000000000000004000004200000000000000000000000000000000B8490000000000004800000002000500242A0000281E000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001A7E050000042A1E0280050000042AAE168001000004731000000A8002000004731100000A8003000004731200000A80040000041680010000042A001B300400AD00000001000011281300000A2C0872010000700A2B067E050000040A06731400000A0B076F1500000A0C0872350000706F1600000A081A6F1700000A086F1800000A726D0000701F0C20000200006F1900000A26086F1800000A166F1A00000A186F1B00000A076F1C00000A086F1D00000A26086F1800000A166F1A00000A6F1E00000A6F1F00000A8005000004DE0A082C06086F2000000ADCDE0A072C06076F2000000ADCDE0B6F2100000A732200000A7A2A00000001280000020023006689000A0000000002001C007995000A0000000000000000A1A1000B140000012E280400000628060000062A1B30030033020000020000117E05000004731000000A0A732300000A0B732300000A0C7E020000046F2400000A280100002B0D731400000A130411046F1500000A1305110572850000706F1600000A11051A6F1700000A11046F1C00000A11056F2600000A130611066F2700000A2C362B2B1106732800000613070611076F1000000611076F2800000A7E0200000411076F1000000611076F2800000A11066F2900000A2DCCDE0C11052C0711056F2000000ADC7E020000046F2400000A066F2400000A280200002B280100002B0B07280300002B2C5D076F2C00000A13082B3A1208282D00000A13097E030000041109120A6F2E00000A2C14110A6F0F0000067E0300000411096F2F00000A267E0200000411096F3000000A261208283100000A2DBDDE0E1208FE160400001B6F2000000ADC7E020000046F2400000A09280200002B280100002B0C08280300002B39AD000000086F2C00000A13083884000000732A000006130B110B1208282D00000A7D170000047E02000004110BFE062B000006733200000A280400002B7E19000004252D17267E18000004FE062E000006733400000A258019000004280500002B280600002B6F26000006110B7B170000041B730C000006130C7E03000004110B7B17000004110C6F3700000A110C6F0D000006261208283100000A3A70FFFFFFDE0E1208FE160400001B6F2000000ADCDE0C11042C0711046F2000000ADC066F3800000A2D0B72B9000070732200000A7ADE19130D72FF000070110D6F2100000A283900000A732200000A7A2A00417C00000200000037000000650000009C0000000C0000000000000002000000D3000000470000001A0100000E00000000000000020000005101000097000000E80100000E00000000000000020000002E000000CA010000F80100000C00000000000000000000000000000019020000190200001900000014000001062A00001B30020034000000030000117E040000040A160B061201283A00000A7E010000042D0B2805000006178001000004DE0A072C0606283B00000ADCDE0326FE1A2A011C0000020008001C24000A000000000000000030300003140000011B3005000901000004000011022D0B72B6010070732200000A7A7E010000042D052808000006283C00000A036F3D00000A0A021540860000007E020000046F3E00000A0B2B601201283F00000A0C1202284000000A6F1E0000060D1202284000000A6F2000000613047E030000046F4100000A6F4200000A13052B111205284300000A090611046F0E000006261205284400000A2DE6DE0E1205FE160A00001B6F2000000ADC1201284500000A2D97DE5E1201FE160700001B6F2000000ADC7E030000040212066F2E00000A2C2B11067E02000004026F4600000A6F1E000006067E02000004026F4600000A6F200000066F0E000006262B1672E4010070028C34000001283900000A732200000A7ADE0326FE1A2A000000414C0000020000006E0000001E0000008C0000000E0000000000000002000000380000006D000000A50000000E000000000000000000000000000000050100000501000003000000100000011B30010019000000000000007E010000042D072808000006DE0A2806000006DE0326FE1A2A000000011000000000000015150003100000011E02281200000A2A9E02734700000A7D0B00000402281200000A02037D0800000402057D0900000402047D0A0000042A1B300200790000000500001102734800000A7D07000004027B07000004027B080000046F4900000A027B07000004176F4A00000A027B07000004176F4B00000A02027B070000046F4C00000A7D06000004160A2B1C027B060000046F4D00000A0B027B0B000004076F4E00000A0617580A06027B0900000432DB170CDE0526160CDE00082A000000011000000000000072720005140000011B3006006A00000006000011140A160B2B0B0717580B1F32284F00000A027B0B00000412006F5000000A2D05071F6432E1071F643311722402007003283900000A732200000A7A0603051614046F5100000A027B0B000004066F4E00000A170CDE1226062C0C027B0B000004066F4E00000AFE1A082A0000011000000000040052560012140000011B30020041000000070000112B17027B0B00000412006F5000000A2C08066F5200000A140A027B0B0000046F5300000A1630DB027B060000046F5400000ADE0C027B0B0000046F5500000ADC2A00000001100000020000003434000C000000001E027B0C0000042A2202037D0C0000042A1E027B0D0000042A2202037D0D0000042A1E027B0E0000042A2202037D0E0000042A1E027B0F0000042A2202037D0F0000042A1E027B100000042A2202037D100000042A1E027B110000042A2202037D110000042A1E027B120000042A2202037D120000042A1E027B130000042A2202037D130000042A1E027B140000042A2202037D140000042A1E027B150000042A2202037D150000042A1E027B160000042A2202037D160000042A1E0228290000062A0013300300A90000000000000002281200000A0203166F5600000A28110000060203176F5700000A28130000060203186F5700000A28150000060203196F5600000A281700000602031A6F5700000A281900000602031B6F5700000A281B00000602031C6F5700000A281D00000602031D6F5700000A281F00000602031E6F5800000A7E5900000A3303142B07031E6F5700000A282100000602031F096F5600000A282300000602031F0A6F5A00000A28250000062A000000133003009000000008000011735B00000A2572AB0200706F5C00000A262502281A0000066F5C00000A262572BB0200706F5C00000A262502281C0000066F5C00000A262572BF0200706F5C00000A26250228140000066F5C00000A262572BB0200706F5C00000A26250228160000060A1200285D00000A6F5C00000A262572C30200706F5C00000A26250228180000066F5C00000A266F1F00000A2A420F01285E00000A027B17000004FE012A2E732D00000680180000042A220F01284000000A2A000042534A4201000100000000000C00000076342E302E33303331390000000005006C000000AC0A0000237E0000180B0000040C000023537472696E6773000000001C170000C802000023555300E4190000100000002347554944000000F41900003404000023426C6F620000000000000002000001571DA209090A000000FA013300160000010000003800000006000000190000002E000000170000005E000000010000003100000008000000020000000D000000190000000B000000010000000400000002000000060000000000F706010000000000060024054109060091054109060058040F090F0061090000060080043D07060007053D070600E8043D07060078053D07060044053D0706005D053D07060097043D0706006C04220906004A0422090600CB043D070600B204EC050600900A1B0706009E00F0000A00AE07D20A0A000303D20A0600E8071B0706007800F0000A005708D20A5700EF0800004700EF08000006008F00F00047004F0700006B00EF08000006002F044109060088001B070E008407C20A0E00F10BC20A06006600F40A0E00E406C20A0A009C0BB0080A00EB02F2070A00F303D1000A005F07D20A0A009D08D20A0A00E503D1000A009108F2070A00CA07D1000A009007F207060083031B070600DD071B0747007607000012007803350806005800F0000A004A08F2070600AA061B0706000709D2050600E305800B060082001B0706004A01D2050E007009C20A06000B071B0706007308800B00000000C800000000000100010001000000CB08DD08410001000100000010008108DD08410006000C0000001000120B810941000C0010000301100001000000410017002A0003211000E6000000410018002C001600AA01B4021300320AB7021300110AC00213001104C90211001506CC0203003207CF020100E40BD30201002A06CC020100F009D70203003401D7022100E009DA020100BC01D70201006302CC0201004702CC020100A202D7020100B802CC0201002C02CC020100F301CC0201001202CC020100CF02CC0201007E02D7020100D801B4020600B901D7023600C400E40216003100E80250200000000096086206F702010057200000000096088006FB0201005F200000000091180009000302008C200000000093005F0B0003020070210000000093001604000302007C21000000009300430A000302003824000000009100FA09000302003C240000000096001B08000302009824000000009600B10604030200FC25000000009600570A000304003426000000008618FA08060004003C26000000008318FA080A03040064260000000083009E0AC8000700FC26000000008300720B110307008427000000008300050806000A00E427000000008308160161000A00EC27000000008308250101000A00F527000000008308C90369000B00FD27000000008308D70310000B000628000000008308AB0369000C000E28000000008308BA0310000C001728000000008308320B61000D001F280000000083083B0B01000D0028280000000083084B0B69000E003028000000008308550B10000E0039280000000083088F0369000F0041280000000083089D0310000F004A2800000000830815036900100052280000000083082703100010005B2800000000830845036900110063280000000083085203100011006C28000000008308B20B690012007428000000008308C10B100012007D28000000008308B209610013008528000000008308C909010013008E280000000083085501C800140096280000000083086301150014009F280000000086083606690015003426000000008318FA0806001500A828000000008318FA081903150060290000000081004B06690016003426000000008618FA0806001600FC2900000000830017001F0316000D2A0000000091180009000317003426000000008618FA0806001700192A0000000083003B002A03170000000100C505000001000B01000002006D0B000001000606000002000B0110100300F109000001005F0300000200C60600000300EA0000000100C50500000100C50500000100C50500000100C50500000100C50500000100C50500000100C50500000100C50500000100C50500000100C50500000100C50500000100470800000100A70B000001000D090900FA0801001100FA0806001900FA080A002900FA0810003100FA0810003900FA0810004100FA0810004900FA0810005100FA0810005900FA0810006100FA0815006900FA0810007100FA0810007900FA081000E100FA0806000C00FA0806001400FA0806008100FA0806001101680332009100FA0810009100F502360019018C0B10001901EF033B009900230A42002901510148002901120753004101BC075A0051012D0706001901D40B61004101AF05650081009E066900590127040600A100390369006101FA0810001C00FA0806000C00800AA2007101440BAE0099006508C3008101740AC8000C005101CC0081014501C80071012B0BD4007101D00BED001C00EC08F9002400E80A08011400B9050D011400CB0516010C00CB0516012400770BC8002C00FA0829017101FF032F013400FA0829017101970A60017101B30A860114005101CC000C00210B61008901890A98019101AA08A3019101AE0AAA019901BB00CD0199019E09D3010C00EC08D9013C00E80AEC014400AF05FF011400A70904024C00EC0817025400E80AFF015400770BC8003C00770BC8000C0012072A025C00FA080600F900FA080600F900DC061000F90071011500F9008E011500F9009D074202F100EB0647025C00D7064D02A9010E085B025C00140860020901CA0667020901210406005C00210B6100F100210406005C004108060081017F0079028101A7067E02810112078302B901BF058802810122078D02C101FA080600C1010E039602A1019E0669004400AA0B080108001900AF022E000B0046032E0013004F032E001B006E032E00230077032E002B008C032E0033008C032E003B008C032E00430077032E004B0092032E0053008C032E005B008C032E006300AA032E006B00D4032E007300E103A3007B002F04C3007B002F0481017B002F04A1017B002F04C1017B002F04E1017B002F0400027B002F0401027B002F0420027B002F0421027B002F0440027B002F0441027B002F0460027B002F0461027B002F0480027B002F0481027B002F04A0027B002F04A1027B002F04C0027B002F04C1027B002F04E0027B002F0400037B002F0420037B002F0440037B002F0460037B002F0480037B002F04A0037B002F04C0037B002F04E0037B002F0400047B002F0420047B002F0440047B002F0460047B002F0480047B002F04A0047B002F042A006D009E01AF013A02530273029202020001000400020000008406360300003A013A030000DB033E030000BE033E0300003F0B3A030000590B3E030000A1033E0300002B033E03000056033E030000C50B3E030000CD093A0300006701420300008D063E03020001000300010002000300020010000500010011000500020012000700010013000700020014000900010015000900020016000B00010017000B00020018000D00010019000D0002001A000F0001001B000F0002001C00110001001D00110002001E00130001001F001300020020001500010021001500020022001700010023001700020024001900010025001900020026001B001A0022009C0002011C015201E401F7010F0222023102048000000100000000000000000000000000AB0000000400000000000000000000009D02DD00000000000400000000000000000000009D02D10000000000040000000000000000000000A602C20A000000000400000000000000000000009D0205040000000005000200060002004B00BF005500BF005700BF00670048016B007A016D0093010000003C3E635F5F446973706C6179436C61737331315F30003C4C6F6164526162626974456E64706F696E74733E625F5F30003C3E395F5F31315F31003C4C6F6164526162626974456E64706F696E74733E625F5F31315F310049456E756D657261626C65603100436F6E63757272656E74537461636B6031004C697374603100476574496E7433320046756E636032004B657956616C75655061697260320044696374696F6E6172796032005261626269744D5153716C436C7234006765745F55544638003C3E39003C4D6F64756C653E0053797374656D2E44617461006D73636F726C6962003C3E6300746F7069630053797374656D2E436F6C6C656374696F6E732E47656E6572696300656E64506F696E744964006765745F456E64706F696E744964007365745F456E64706F696E74496400526162626974456E64706F696E74496400526561640054687265616400416464006765745F4973456E61626C6564007365745F4973456E61626C6564007365745F4175746F6D617469635265636F76657279456E61626C6564007365745F546F706F6C6F67795265636F76657279456E61626C6564005F6973496E697469616C69736564006964003C456E64706F696E7449643E6B5F5F4261636B696E674669656C64003C4973456E61626C65643E6B5F5F4261636B696E674669656C64003C4C6F67696E50617373776F72643E6B5F5F4261636B696E674669656C64003C45786368616E67653E6B5F5F4261636B696E674669656C64003C4C6F67696E4E616D653E6B5F5F4261636B696E674669656C64003C5365727665724E616D653E6B5F5F4261636B696E674669656C64003C416C6961734E616D653E6B5F5F4261636B696E674669656C64003C436F6E6E656374696F6E4368616E6E656C733E6B5F5F4261636B696E674669656C64003C506F72743E6B5F5F4261636B696E674669656C64003C56486F73743E6B5F5F4261636B696E674669656C64003C526F7574696E674B65793E6B5F5F4261636B696E674669656C64004462436F6D6D616E6400437265617465436F6D6D616E640053716C436F6D6D616E6400417070656E64006765745F4C6F67696E50617373776F7264007365745F4C6F67696E50617373776F7264006765745F4D657373616765006765745F45786368616E6765007365745F45786368616E67650065786368616E6765006765745F4973417661696C61626C6500456E756D657261626C650049446973706F7361626C65006765745F4C6F67696E4E616D65007365745F4C6F67696E4E616D65006765745F5365727665724E616D65007365745F5365727665724E616D65006765745F416C6961734E616D65007365745F416C6961734E616D650053716C446254797065007365745F436F6D6D616E64547970650057686572650053797374656D2E436F7265005F6C6F636B496E697469616C69736500436C6F736500446973706F736500436F6D70696C657247656E65726174656441747472696275746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465006765745F56616C75650054727947657456616C75650076616C75650052656D6F76650053797374656D2E546872656164696E6700456E636F64696E670053797374656D2E52756E74696D652E56657273696F6E696E6700616D7170436F6E6E537472696E67005F6C6F63616C686F7374436F6E6E537472696E67005F636F6E6E537472696E67006765745F436F6E6E656374696F6E537472696E6700437265617465436F6E6E656374696F6E537472696E67006765745F4C6F63616C686F7374436F6E6E656374696F6E537472696E67007365745F4C6F63616C686F7374436F6E6E656374696F6E537472696E6700546F537472696E6700476574537472696E670070725F636C725F506F73745261626269744D7367006D73670042617369635075626C6973680050757368007365745F55726900494D6F64656C004372656174654D6F64656C005261626269744D5153716C436C72342E646C6C0044424E756C6C006765745F4974656D0053797374656D00476574426F6F6C65616E004F70656E00526162626974436F6E6E0053797374656D2E5265666C656374696F6E0056616C7565436F6C6C656374696F6E0053716C506172616D65746572436F6C6C656374696F6E004B6579436F6C6C656374696F6E0049436F6E6E656374696F6E004462436F6E6E656374696F6E00437265617465436F6E6E656374696F6E0053716C436F6E6E656374696F6E007365745F446972656374696F6E00506172616D65746572446972656374696F6E004170706C69636174696F6E457863657074696F6E0053797374656D2E446174612E436F6D6D6F6E0053687574646F776E00536C65657000547279506F700070725F636C725F496E697469616C6973655261626269744D710053797374656D2E4C696E7100436C656172006472004462446174615265616465720053716C44617461526561646572004578656375746552656164657200537472696E674275696C646572005261626269745075626C6973686572004462506172616D657465720053716C506172616D6574657200456E746572004D6963726F736F66742E53716C5365727665722E536572766572005261626269744D5153716C536572766572005261626269744D5153716C436C7200476574456E756D657261746F72002E63746F72002E6363746F72004D6F6E69746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730049426173696350726F70657274696573005261626269744D5153716C436C722E48656C706572436C6173736573004765744279746573006765745F56616C756573006765745F436F6E6E656374696F6E4368616E6E656C73007365745F436F6E6E656374696F6E4368616E6E656C73005F7261626269744368616E6E656C73005F6368616E6E656C73004372656174655261626269745075626C697368657273005F7261626269745075626C697368657273006765745F506172616D6574657273005F72656D6F7465456E64706F696E7473004C6F6164526162626974456E64706F696E74730070725F636C725F52656C6F6164526162626974456E64706F696E7473006765745F486173526F7773006765745F4B65797300466F726D6174004F626A6563740053656C65637400496E7465726E616C436F6E6E65637400457869740046697273744F7244656661756C74005261626269744D512E436C69656E740053797374656D2E446174612E53716C436C69656E74006765745F43757272656E740053797374656D2E436F6C6C656374696F6E732E436F6E63757272656E740052656D6F7465456E64706F696E74006765745F436F756E7400457863657074006765745F506F7274007365745F506F727400546F4C697374006765745F56486F7374007365745F56486F7374004C6F61644C6F63616C486F7374006D7367546F506F7374004D6F76654E6578740053797374656D2E54657874007365745F436F6D6D616E64546578740053716C436F6E74657874006578006765745F4B6579006765745F526F7574696E674B6579007365745F526F7574696E674B657900416E7900457865637574654E6F6E5175657279005F636F6E6E466163746F727900436F6E6E656374696F6E466163746F72790000003343006F006E007400650078007400200043006F006E006E0065006300740069006F006E0020003D0020007400720075006500003772006D0071002E00700072005F004700650074004C006F00630061006C004400420043006F006E006E0053007400720069006E0067000017400043006F006E006E0053007400720069006E006700003372006D0071002E00700072005F0047006500740052006100620062006900740045006E00640070006F0069006E007400730000454E006F00200065006E00610062006C00650064002000720061006200620069007400200065006E00640070006F0069006E007400730020006500780069007300740073000080B54500720072006F007200200069006E003A0020005200610062006200690074004D005100530071006C005300650072007600650072002E004C006F006100640052006100620062006900740045006E00640070006F0069006E00740073002E00200054006800650020006500720072006F0072002000690073003A0020004500720072006F0072002000720061006200620069007400200065006E00640070006F0069006E00740073003A0020007B0030007D00002D45006E00640070006F0069006E007400490064002000630061006E006E006F00740020006200650020003000003F45006E00640070006F0069006E007400490064003A0020007B0030007D002C00200064006F006500730020006E006F0074002000650078006900730074000080854300680061006E006E0065006C00200070006F006F006C00200062006C006F0063006B006500640020007700680065006E00200074007200790069006E006700200074006F00200070006F007300740020006D00650073007300610067006500200074006F002000450078006300680061006E00670065003A0020007B0030007D002E00000F61006D00710070003A002F002F0000033A000003400000032F000000DC885012D0C80444A8F9AEF78AB3A38F00042001010803200001052001011111042001010E04200101020715124502081210071512450208120C0707030E1249124D03000002042000124D062001011180910520001280950A20031280990E11809D0806200112809908062001011180A5032000080320001C0320000E2E070E151245020812101512550108151255010815125501081249124D1259121015115D010808120C1214120C12510515125501080B2000151280B5021300130110100101151255011E00151280BD011E00030A0108042000125903200002072002011300130118100102151280BD011E00151280BD011E00151280BD011E000B10010102151280BD011E0008200015115D0113000515115D010804200013000820020213001013010520010213000C151275021511650208121002052002011C1818100102151280BD011E00151280BD011E00151275021E0002090A01151165020812100D1512750215116502081210121019100202151280BD011E01151280BD011E00151275021E001E010B0A021511650208121012100C1001011E00151280BD011E00040A0112100500020E0E1C0407021C02060002011C1002040001011C1D07071D0515116102081210151165020812100E0E15116D0208120C120C0500001280CD0520011D050E0A2000151161021300130107151161020812100A20001511650213001301071511650208121004200013010A20001512690213001301071512690208120C0A200015116D02130013010715116D0208120C062001130113000815128081011280850707030812808502042000127905200012808505200101130007070312808508020400010108062001021013000B2005010E0E021280D91D0505070112808504200108080420010E080420011C0804061280DD0420010208030701080620011280E10E08B77A5C561934E0890889E7D7C5FEBA84CE040500000002060208061512450208121008061512450208120C02061C02060E030612790306127D02060809061512808101128085030612180E06151275021511650208121012100300000E040001010E0300000105000201080E062003010E0808072003020E1D050E0520010112590A200102151165020812100B20011210151165020812100308000E032800080328000E032800020801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000001401000F5261626269744D5153716C436C7234000005010000000017010012436F7079726967687420C2A920203230313700002901002435313465353663652D393039382D343761612D396335642D34333633313637333763613000000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E352E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E352E3204010000000000000059479C5800000000020000001C01000068480000682A000052534453414DEFA43863C942BDA9DCEEE11D73A801000000443A5C5261626269744D512D53716C5365727665725C7372635C5261626269744D5153716C436C72345C6F626A5C52656C656173655C5261626269744D5153716C436C72342E70646200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000AC4900000000000000000000C6490000002000000000000000000000000000000000000000000000B8490000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF2500200010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000586000004C03000000000000000000004C0334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004AC020000010053007400720069006E006700460069006C00650049006E0066006F0000008802000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E007400730000000000000022000100010043006F006D00700061006E0079004E0061006D0065000000000000000000480010000100460069006C0065004400650073006300720069007000740069006F006E00000000005200610062006200690074004D005100530071006C0043006C00720034000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000048001400010049006E007400650072006E0061006C004E0061006D00650000005200610062006200690074004D005100530071006C0043006C00720034002E0064006C006C0000004800120001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A90020002000320030003100370000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000005000140001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000005200610062006200690074004D005100530071006C0043006C00720034002E0064006C006C000000400010000100500072006F0064007500630074004E0061006D006500000000005200610062006200690074004D005100530071006C0043006C00720034000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E00300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000C000000D83900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

--the following name needs also to be used (without single-quotes)
-- in the CREATE and ALTER statements below
DECLARE @asmName sysname = 'RabbitMQ.SqlServer';

--end setting parameters

DECLARE @dbname nvarchar(256);
DECLARE @isTrustworthy bit;
DECLARE @alterStmt nvarchar(512);
DECLARE @isCLREnabled int;
DECLARE @isCreateAlter bit = 0;
DECLARE @spConfigureTab TABLE (name varchar(256), minimum int, maximum int, config_value int, run_value int)


--check if clr is enabled, if not return out - as it cannot be done dynamically
INSERT INTO @spConfigureTab
EXEC sp_Configure 'CLR Enabled'

SELECT @isCLREnabled = run_value
FROM @spConfigureTab

IF(@isCLREnabled = 0)
BEGIN
  RAISERROR('CLR is not enabled on this db server. To enable, execute "sp_configure ''CLR Enabled'', 1 GO RECONFIGURE GO". This script now exits.', 16, -1)
  RETURN;
END

--check if we are trustworthy
SELECT @dbname = name, @isTrustworthy = is_trustworthy_on 
FROM sys.databases
WHERE name = db_name()

IF (@isTrustworthy = 0)
BEGIN
  SET @alterStmt = 'ALTER DATABASE ' + @dbname + ' SET TRUSTWORTHY ON;'
  EXEC( @alterStmt);
END

IF NOT EXISTS (SELECT * FROM sys.assemblies asms WHERE asms.name = @asmName)
BEGIN

  CREATE ASSEMBLY [RabbitMQ.SqlServer]
  AUTHORIZATION rmq
  FROM @AssemblyData
  WITH PERMISSION_SET = UNSAFE;  	

END  
ELSE
BEGIN
  
  IF NOT EXISTS(SELECT 1 FROM sys.assembly_files WHERE content = @AssemblyData)
  BEGIN
  
    ALTER ASSEMBLY [RabbitMQ.SqlServer]
    FROM @AssemblyData
    WITH PERMISSION_SET = UNSAFE;

  END
  ELSE
  BEGIN
    PRINT 'The assembly already exists. It is not being altered.'
  END
  
END
GO



